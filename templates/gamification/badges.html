{% extends 'base.html' %}

{% block content %}
<div class="hero-section-small">
    <div class="container">
        <h1 class="display-5">Badges & Achievements</h1>
        <p class="lead">Unlock badges by making an impact in your community</p>
    </div>
</div>

<div class="container mt-5">
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow">
                <div class="card-body text-center p-4">
                    <h3 class="text-success mb-2">You have earned {{ user_badges.count }} badge{{ user_badges.count|pluralize }}</h3>
                    <p class="text-muted mb-0">Keep sharing food and helping the community to earn more!</p>
                </div>
            </div>
        </div>
    </div>
    
    <h3 class="mb-4">Your Badges</h3>
    <div class="row mb-5">
        {% if user_badges %}
            {% for user_badge in user_badges %}
                <div class="col-md-4 col-lg-3 mb-4">
                    <div class="card h-100 shadow-sm border-success">
                        <div class="card-body text-center">
                            {% if user_badge.badge.icon %}
                                <img src="{{ user_badge.badge.icon.url }}" alt="{{ user_badge.badge.name }}" 
                                     class="img-fluid mb-3" style="max-width: 100px;">
                            {% else %}
                                <div class="bg-success text-white rounded-circle d-flex align-items-center justify-content-center mx-auto mb-3" 
                                     style="width: 100px; height: 100px;">
                                    <span style="font-size: 2.5rem;">ğŸ†</span>
                                </div>
                            {% endif %}
                            <h5 class="text-success">{{ user_badge.badge.name }}</h5>
                            <p class="text-muted small">{{ user_badge.badge.description }}</p>
                            <small class="text-muted">Earned on {{ user_badge.awarded_at|date:"M d, Y" }}</small>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <div class="col-12">
                <div class="alert alert-info text-center" role="alert">
                    <h5>No badges earned yet</h5>
                    <p class="mb-0">Start sharing food and helping others to earn your first badge!</p>
                </div>
            </div>
        {% endif %}
    </div>
    
    <h3 class="mb-4">Available Badges</h3>
    <div class="row">
        {% for badge in all_badges %}
            {% with user_has_badge=user_badges|dictsort:"badge.id" %}
                <div class="col-md-4 col-lg-3 mb-4">
                    <div class="card h-100 shadow-sm {% if badge in user_badges %}opacity-50{% endif %}">
                        <div class="card-body text-center">
                            {% if badge.icon %}
                                <img src="{{ badge.icon.url }}" alt="{{ badge.name }}" 
                                     class="img-fluid mb-3 {% if badge not in user_badges %}grayscale{% endif %}" 
                                     style="max-width: 100px;">
                            {% else %}
                                <div class="bg-secondary text-white rounded-circle d-flex align-items-center justify-content-center mx-auto mb-3" 
                                     style="width: 100px; height: 100px;">
                                    <span style="font-size: 2.5rem;">ğŸ”’</span>
                                </div>
                            {% endif %}
                            <h6>{{ badge.name }}</h6>
                            <p class="text-muted small">{{ badge.description }}</p>
                            <small class="text-muted">Requires {{ badge.points_required }} points</small>
                        </div>
                    </div>
                </div>
            {% endwith %}
        {% endfor %}
    </div>
</div>

<style>
    .hero-section-small {
        background: linear-gradient(135deg, #2e8b57, #3cb371);
        color: white;
        padding: 3rem 0;
        margin-bottom: 0;
    }
    
    .grayscale {
        filter: grayscale(100%);
    }
</style>
{% endblock %}

